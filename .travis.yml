language: node_js
node_js:
  'stable'

cache:
  directories:
    - '$HOME/.sonar/cache'
    - "$HOME/.npm"

jobs:
  include:
    - stage: "Compile"
      script: npm ci

    - stage: "Test"
      script: npm run test
      
    - stage: "SonarQube"
      addons:
        sonarcloud:
          organization: "papaya" 
      script: sonar-scanner


notifications:
  email: false
  on_success: change
  on_failure: always