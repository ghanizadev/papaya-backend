language: node_js
node_js: stable
addons:
  sonarcloud:
    organization: papaya
script:
- sonar-scanner
cache:
  directories:
  - "$HOME/.sonar/cache"
  - "$HOME/.npm"
jobs:
  include:
  - stage: Compile
    script: npm ci
  - stage: Test
    script: npm run test
  - stage: Quality gate
    script: sonar-scanner
notifications:
  email: false
  on_success: change
  on_failure: always
deploy:
  provider: heroku
  api_key:
    secure: sXf34yJirHsWG9ybQc/k4FOJfXxpCrrdSkJjghoguQ2chKDyGjydhp4Y3qBTx/8MyBFoKEEPcsmsY/rKVBX57dq9hLWN73ZZ6nhLeUCDDKql2XXU5POj6ij+nj5kKI7Q/qL/PbI74lkA3lcjcJODDFyrW+yCEKGKKsu5HYlY/iEtmKBffZvH47t1fJ4L7paC0kSlTxNrY4Qb6Yjsv6Jzcnng/ulUAiX9tRuo3NcsQiZkpz3zJHWviMwbgnlb99vO8BFsg/6sI6FQs2lDdno58Q2pbu7RmMY0UgQFc0SLs4eLUFPCXTRImWD0ldykL459XdIdNENgqEPum3z3iSXoHGDuI+UMrw99m/Omtk67FLMYaTz+eaYP5T9EZgByEg8acm/XFeEmJJpU48hQaM+gac0CxQC2v8uwHjZ3IhOFS2GWvYmfPFwkp9zFfHLJlKlwi3KkkY0qU5uDHZp5trmkGJAGjTYcgtjNZrmwFGwk3pwITdQ6vipR6JAGJLU+2ZM+nH1YiSFZxBIfCm1s8oaTkMZzWR+uX6vq4E5s+tUNFa3J/mkuZWd5hpv6+Y6Jzy+rp/IdpC1JIPCT7LBjKYjolQbmrs0P94ey5lQl3SwRTD2tnOdnKQfUtOqJI/j4iGW86UZ+mFpDtuM++nDfkB8CKHGZjGvLHzF254c9XOSfltk=
  app: papaya-server
  on:
    repo: ghanizadev/papaya-backend
