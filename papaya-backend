language: node_js
node_js: stable
cache:
  directories:
  - "$HOME/.sonar/cache"
  - "$HOME/.npm"
jobs:
  include:
  - stage: Compile
    script: npm ci
  - stage: Test
    script: npm run test
  - stage: SonarQube
    addons:
      sonarcloud:
        organization: papaya
    script: sonar-scanner
deploy:
  provider: heroku
  api_key:
    secure: 0eVELGE+faBtGnfkdWtzSdPRvWAq6JhmdjKKT3UVC9iD0FEKAa85OJs0QSNl7xyBMn4+GxLIm0yK2L2VCK4sf1z0gdCaWNCaBhkBGkPCx4ZpVIdnpovLwsHN4PwTAR/IeDpxR7QE7MZ5YnVgJLfXqBFpr33/Lw1+Tjv6fdMkBn2MOAhl4ISH15UD7C7drDV5j3KwjMzyvnO2mEUOROwo1nBjER2fMsRxr4kd/ZuKeDDgW02BG1FHsKhnzPRQWNWeXFc42NXGIngguYPOFFYdF5NejLtwbLs5HHIWcPJA8mFuZu/tn9MpGavcbUpQJEaBJ0pdJt4GggUg6ANx736MLkybZdESsEgclfCfSRJzk6bkDuLN8x9ltNzAaH1X/KHyGX1ndE1GSjouQ4+ZHVNI3FzG+bWFrH69LAmA9R4JwnxhBS2qpx23eRdv0P22gKUn1YULqHIYN0bvS6aDR55Lam57jtJKQm0r8PmXzAfhb+G7sj1n1XU2IwR4JY239B6xB6ENJPK0vSf5jGGqZIE/kJn9j9J8hfg81+mzxHsnflCTlA3pUwgKZelSyOdhbyzmm978S7mJ5HMj+y+g1y+JXwa2AWEuYFBjUbeJFMaSFg29FbEAPFzRRjGp9bR41hS7JkfpN2pibIl11LkTnv+gVrRYHUb2JQd3aqa8DkrA+/A=
  app: papaya-servr
  on:
    repo: ghanizadev/papaya-backend
notifications:
  email: false
  on_success: change
  on_failure: always
